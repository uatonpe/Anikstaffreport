<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Anik Financial Services | Professional Reporting System</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --anik-blue: #283a6d; 
            --anik-navy: #1e293b;
            --soft-bg: #f1f5f9; 
            --success-green: #10b981;
            --error-red: #ef4444;
            --accent-blue: #3b82f6;
        }

        body { 
            font-family: 'Mukta', sans-serif; 
            background-color: var(--soft-bg); 
            color: var(--anik-navy);
            margin: 0;
            padding-bottom: 120px; /* Space for sticky footer */
            overflow-x: hidden;
        }

        /* 10. Sticky Header Branding */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: white;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-bottom: 1px solid #e2e8f0;
        }

        .main-container {
            width: 100%;
            max-width: 650px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* 3. Visual Hierarchy: Card & Table Styles */
        .pro-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            font-size: 1.15rem;
            font-weight: 800;
            color: var(--anik-blue);
            display: flex;
            align-items: center; gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f1f5f9;
        }

        /* 1. Accordion for FX Sections */
        .accordion-item {
            background: white;
            border-radius: 16px;
            margin-bottom: 12px;
            overflow: hidden;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .accordion-header {
            padding: 18px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            background: #fff;
            user-select: none;
        }

        .accordion-header.active {
            background: #f8fafc;
            border-bottom: 1px solid #f1f5f9;
        }

        .accordion-content {
            display: none;
            padding: 20px;
        }

        /* Table UI Improvements */
        .table-wrap { 
            overflow-x: auto; 
            border-radius: 12px; 
            border: 1px solid #e2e8f0; 
            background: #fff;
        }
        
        table { width: 100%; border-collapse: collapse; font-size: 0.95rem; }
        th { background: #f8fafc; padding: 12px; color: #64748b; font-weight: 800; text-align: left; font-size: 0.75rem; text-transform: uppercase; }
        td { padding: 10px; border-bottom: 1px solid #f1f5f9; }
        
        /* 3. Highlighting Amount Fields */
        .amt-input { background-color: #f0f9ff !important; font-weight: 800 !important; color: var(--anik-blue); border-color: #bae6fd !important; }
        .total-row { background: #f1f5f9; font-weight: 800; color: var(--anik-blue); }

        /* Form Inputs */
        .pro-input {
            width: 100%;
            padding: 12px 16px;
            border: 1.5px solid #cbd5e1;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.2s;
            background: #fff;
        }

        .pro-input:focus {
            border-color: var(--anik-blue);
            outline: none;
            box-shadow: 0 0 0 4px rgba(40, 58, 109, 0.1);
        }

        .input-label {
            display: block;
            font-size: 0.8rem;
            font-weight: 800;
            color: #64748b;
            text-transform: uppercase;
            margin-bottom: 6px;
            margin-left: 4px;
        }

        /* 2. Sticky Action Bar */
        .sticky-action-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 16px 24px;
            box-shadow: 0 -10px 25px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 200;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sticky-action-bar.visible { transform: translateY(0); }

        /* 4. Leave Card Reassurance */
        .leave-card {
            background: #eff6ff;
            border: 2px dashed #3b82f6;
            border-radius: 24px;
            padding: 40px 24px;
            text-align: center;
            margin-top: 20px;
        }

        /* 5. Warning Card (Duplicate) */
        .warning-card {
            background: #fff1f2;
            border: 1px solid #fecdd3;
            color: #be123c;
            padding: 24px;
            border-radius: 20px;
            text-align: center;
            margin: 20px 0;
            display: none;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .badge { padding: 4px 12px; border-radius: 8px; font-size: 0.75rem; font-weight: 800; }
        .badge-ok { background: #dcfce7; color: #166534; }
        .badge-fail { background: #fee2e2; color: #991b1b; }

        #loader-overlay {
            position: fixed; inset: 0; background: rgba(255,255,255,0.98);
            display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 10000;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .main-container { padding: 0 10px; }
            .pro-card { padding: 16px; }
        }
    </style>
</head>
<body>

    <!-- STICKY HEADER -->
    <header class="sticky-header">
        <img src="https://anikfin.com/wp-content/uploads/2024/06/anik-horizontal-1-1024x400.png" alt="Anik Logo" class="h-8 md:h-10 object-contain">
        <div class="text-right">
            <h1 class="text-sm font-black text-blue-900 leading-none">Reporting System</h1>
            <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Anik Financial Services</p>
        </div>
    </header>

    <!-- LOADER -->
    <div id="loader-overlay">
        <div class="animate-spin rounded-full h-12 w-12 border-4 border-blue-900 border-t-transparent mb-4"></div>
        <p id="loaderText" class="font-black text-blue-900">‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡§æ...</p>
    </div>

    <!-- 7. SUCCESS SCREEN (WITH AUDIT DETAILS) -->
    <div id="success-overlay" class="fixed inset-0 bg-white z-[10001] hidden flex-col items-center justify-center p-8 text-center">
        <div class="w-24 h-24 bg-green-500 text-white rounded-full flex items-center justify-center text-5xl mb-6 shadow-2xl shadow-green-200">‚úì</div>
        <h2 class="text-3xl font-black text-slate-800 mb-2">‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§ú‡§Æ‡§æ ‡§ù‡§æ‡§≤‡§æ!</h2>
        <p class="text-slate-500 mb-8 font-medium">‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä‡§∞‡§ø‡§§‡•ç‡§Ø‡§æ ‡§π‡•á‡§° ‡§ë‡§´‡§ø‡§∏‡§≤‡§æ ‡§™‡§æ‡§†‡§µ‡§≤‡•Ä ‡§Ü‡§π‡•á.</p>
        
        <div id="successDetails" class="bg-slate-50 p-6 rounded-3xl w-full max-w-sm mb-10 text-left space-y-3 border border-slate-100 shadow-inner">
            <!-- Dynamic Data Injection -->
        </div>

        <button onclick="location.reload()" class="w-full max-w-sm bg-blue-900 text-white py-5 rounded-2xl font-black text-xl shadow-xl shadow-blue-100 active:scale-95 transition-transform">‡§™‡§∞‡§§ ‡§ú‡§æ (Home)</button>
    </div>

    <div class="main-container">
        <!-- SELECTION BLOCK -->
        <div class="bg-white p-6 rounded-[32px] shadow-sm border border-slate-200 mb-6 space-y-5">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div>
                    <label class="input-label">‡•ß. ‡§∂‡§æ‡§ñ‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</label>
                    <select id="unitSelect" class="pro-input" onchange="filterStaff()">
                        <option value="">-- ‡§∂‡§æ‡§ñ‡§æ ‡§®‡§ø‡§µ‡§°‡§æ --</option>
                    </select>
                </div>
                <div>
                    <label class="input-label">‡•®. ‡§§‡•Å‡§Æ‡§ö‡•á ‡§®‡§æ‡§µ ‡§®‡§ø‡§µ‡§°‡§æ</label>
                    <select id="empSelect" class="pro-input" onchange="checkStatusAndInit()">
                        <option value="">‡§Ü‡§ß‡•Ä ‡§∂‡§æ‡§ñ‡§æ ‡§®‡§ø‡§µ‡§°‡§æ...</option>
                    </select>
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-5">
                <div>
                    <label class="input-label">‡•©. ‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï</label>
                    <input type="date" id="reportDate" class="pro-input" onchange="checkStatusAndInit()">
                    <p class="text-[10px] text-orange-600 font-bold mt-2 ml-1">‚óè ‡§Æ‡§æ‡§ó‡•Ä‡§≤ ‡•® ‡§¶‡§ø‡§µ‡§∏‡§æ‡§Ç‡§ö‡•á ‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§≠‡§∞‡§§‡§æ ‡§Ø‡•á‡§§‡•Ä‡§≤.</p>
                </div>
                <div>
                    <label class="input-label text-blue-600">‡•™. ‡§Ü‡§ú ‡§∞‡§ú‡§æ ‡§π‡•ã‡§§‡•Ä ‡§ï‡§æ?</label>
                    <select id="leaveSelect" class="pro-input bg-blue-50 border-blue-200" onchange="handleLeave()">
                        <option value="‡§®‡§æ‡§π‡•Ä">‡§®‡§æ‡§π‡•Ä (Working Today)</option>
                        <option value="‡§π‡•ã">‡§π‡•ã (On Leave)</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- 5. DUPLICATE MESSAGE (INLINE) -->
        <div id="duplicateMsg" class="warning-card">
            <div class="text-4xl mb-3">‚ö†Ô∏è</div>
            <h3 class="text-xl font-black">‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§Ü‡§ß‡•Ä‡§ö ‡§ú‡§Æ‡§æ ‡§Ü‡§π‡•á!</h3>
            <p class="text-sm font-medium opacity-80 mt-1">‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§§‡§æ‡§∞‡§ñ‡•á‡§ö‡§æ ‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§∏‡§ø‡§∏‡•ç‡§ü‡•Ä‡§Æ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§Ü‡§ß‡•Ä‡§ö ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§Ü‡§π‡•á. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•Å‡§∏‡§∞‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§®‡§ø‡§µ‡§°‡§æ.</p>
        </div>

        <!-- 4. LEAVE REASSURANCE -->
        <div id="leaveConfirmation" class="hidden">
            <div class="leave-card">
                <div class="text-5xl mb-4">üè†</div>
                <h3 class="text-2xl font-black text-blue-900">‡§Ü‡§ú ‡§∞‡§ú‡§æ (On Leave)</h3>
                <p class="text-slate-600 font-bold mt-2 mb-8 px-4">‡§Ü‡§ú ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§∞‡§ú‡•á‡§µ‡§∞ ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§Æ‡•Å‡§≥‡•á ‡§ï‡•ã‡§£‡§§‡•Ä‡§π‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§≠‡§∞‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§ó‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä. ‡§´‡§ï‡•ç‡§§ ‡§ñ‡§æ‡§≤‡•Ä‡§≤ ‡§¨‡§ü‡§£ ‡§¶‡§æ‡§¨‡•Ç‡§® ‡§®‡•ã‡§Ç‡§¶ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ï‡§∞‡§æ.</p>
                <div class="inline-block px-6 py-2 bg-white rounded-full border border-blue-100 text-blue-800 font-black text-sm uppercase tracking-tighter shadow-sm">
                    Press Submit to Confirm Leave
                </div>
            </div>
        </div>

        <!-- MAIN FORM SECTIONS -->
        <form id="masterForm" class="hidden">
            
            <!-- BRANCH MANAGER (BM) SECTION -->
            <div id="role-BM" class="role-section hidden">
                <div class="flex items-center gap-2 mb-5 ml-1">
                    <span class="h-3 w-3 bg-blue-600 rounded-full"></span>
                    <h2 class="font-black text-slate-800 uppercase tracking-widest text-sm">Branch Manager Daily Reporting</h2>
                </div>

                <div class="pro-card">
                    <h3 class="section-title">‡§Ü‡§™‡§≤‡•ç‡§Ø‡§æ ‡§∂‡§æ‡§ñ‡•á‡§ö‡•Ä ‡§è‡§ï‡•Ç‡§£ ‡§∞‡§ø‡§ï‡§µ‡•ç‡§π‡§∞‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡•Ä (‡§Ü‡§ú‡§ö‡•Ä ‡§∞‡•á‡§ó‡•ç‡§Ø‡•Å‡§∞‡§≤ ‡§µ ‡§ì‡§°‡•Ä ‡§¶‡•ã‡§®‡•ç‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≥‡•Å‡§®) </h3>
                    <div class="grid grid-cols-2 gap-5">
                        <div><label class="input-label">‡§ñ‡§æ‡§§‡•á</label><input type="number" data-label="BM_Acc" class="pro-input dyn-bm" placeholder="0"></div>
                        <div><label class="input-label">‡§∞‡§ï‡•ç‡§ï‡§Æ (‚Çπ)</label><input type="number" data-label="BM_Amt" class="pro-input dyn-bm amt-input" placeholder="‚Çπ"></div>
                        <div><label class="input-label">‡§§‡•ç‡§Ø‡§æ‡§™‡•à‡§ï‡•Ä ‡§ï‡•Ö‡§∂ ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®</label><input type="number" data-label="BM_Cash" class="pro-input dyn-bm" placeholder="0"></div>
                        <div><label class="input-label">‡§§‡•ç‡§Ø‡§æ‡§™‡•à‡§ï‡•Ä ‡§°‡§ø‡§ú‡•Ä‡§ü‡§≤ ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§® </label><input type="number" data-label="BM_Digi" class="pro-input dyn-bm" placeholder="0"></div>
                    </div>
                </div>

                <div class="pro-card">
                    <h3 class="section-title">‡§ì‡§°‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡•Ä (Aging Report)</h3>
                    <div class="space-y-4">
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">1-30 ‡§¶‡§ø‡§µ‡§∏:</span>
                            <input type="number" data-label="BM_OD1_C" placeholder="AC" class="pro-input dyn-bm">
                            <input type="number" data-label="BM_OD1_A" placeholder="‚Çπ" class="pro-input dyn-bm amt-input">
                        </div>
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">31-90 ‡§¶‡§ø‡§µ‡§∏:</span>
                            <input type="number" data-label="BM_OD2_C" placeholder="AC" class="pro-input dyn-bm">
                            <input type="number" data-label="BM_OD2_A" placeholder="‚Çπ" class="pro-input dyn-bm amt-input">
                        </div>
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">91+ ‡§¶‡§ø‡§µ‡§∏:</span>
                            <input type="number" data-label="BM_OD3_C" placeholder="AC" class="pro-input dyn-bm">
                            <input type="number" data-label="BM_OD3_A" placeholder="‚Çπ" class="pro-input dyn-bm amt-input">
                        </div>
                    </div>
                </div>

               <div class="pro-card">
                    <h3 class="section-title">‡§Ü‡§ú‡§ö‡•á ‡§µ‡§æ‡§ü‡§™ </h3>
                    <div class="space-y-4">
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ </span>
                            <input type="number" data-label="Disbursment_Customers" placeholder="No of Customers" class="pro-input dyn-bm">
                        </div>
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">‡§∞‡§ï‡•ç‡§ï‡§Æ</span>
                            <input type="number" data-label="Disbursment_Amount" placeholder="AC" class="pro-input dyn-bm">
                        </div>
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">‡§§‡•ç‡§Ø‡§æ‡§™‡•à‡§ï‡•Ä AutoPay ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§™‡•Å‡§∞‡•ç‡§£ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ </span>
                            <input type="number" data-label="Connet_To_Autopay" placeholder="Auto Pay No" class="pro-input dyn-bm">
                        </div>
                    </div>
                </div>

            <div class="pro-card">
                    <h3 class="section-title">‡§Ü‡§ú‡§ö‡•á ‡§Ö‡•Ö‡§™‡•ç‡§∞‡§æ‡§Ø‡§ù‡§≤ ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ </h3>
                    <div class="space-y-4">
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500"> ‡§è‡§ï‡•Å‡§£ ‡§Ö‡•Ö‡§™‡•ç‡§∞‡§æ‡§Ø‡§ù‡§≤  </span>
                            <input type="number" data-label="Total_Apprisal_Today" placeholder="No of Apprisal" class="pro-input dyn-bm">
                        </div>
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">‡§§‡•ç‡§Ø‡§æ‡§™‡•à‡§ï‡•Ä ‡§Æ‡§Ç‡§ú‡•Å‡§∞ </span>
                            <input type="number" data-label="Apprisal_Sanction" placeholder="Sanction" class="pro-input dyn-bm">
                        </div>
                        <div class="flex gap-3 items-center">
                            <span class="w-32 text-xs font-black text-slate-500">‡§®‡§æ‡§Æ‡§Ç‡§ú‡•Å‡§∞ </span>
                            <input type="number" data-label="Apprisal_Reject" placeholder="Rejected" class="pro-input dyn-bm">
                        </div>
                    </div>
                </div>



                <div class="pro-card">
                    <h3 class="section-title">‡§¨‡•à‡§†‡§ï‡§æ / ‡§µ‡•ç‡§π‡•Ä‡§ú‡•Ä‡§ü ‡§µ ‡§ï‡•Ö‡§∂ ‡§∂‡§ø‡§≤‡•ç‡§≤‡§ï ‡§§‡§™‡§∂‡•Ä‡§≤</h3>
                    <div class="space-y-5">
                        <div>
                            <label class="input-label">‡§Ü‡§ú‡§ö‡•ç‡§Ø‡§æ ‡§¨‡•à‡§†‡§ï‡§æ‡§Ç‡§ö‡•Ä / ‡§µ‡•ç‡§π‡•Ä‡§ú‡•Ä‡§ü ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ</label>
                            <input type="number" data-label="BM_Meet_Cnt" class="pro-input dyn-bm" placeholder="0">
                        </div>
                        <div>
                            <label class="input-label">‡§¨‡•à‡§†‡§ï‡•Ä‡§§‡•Ä‡§≤ / ‡§µ‡•ç‡§π‡•Ä‡§ú‡•Ä‡§ü ‡§Æ‡§π‡§§‡•ç‡§µ‡§æ‡§ö‡•á ‡§Æ‡•Å‡§¶‡•ç‡§¶‡•á</label>
                            <textarea data-label="BM_Meet_Notes" class="pro-input h-28 dyn-bm" placeholder="‡§Ø‡•á‡§•‡•á ‡§∏‡§µ‡§ø‡§∏‡•ç‡§§‡§∞ ‡§≤‡§ø‡§π‡§æ..."></textarea>
                        </div>
                        <div>
                            <label class="input-label">‡§Ü‡§™‡§≤‡•ç‡§Ø‡§æ ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‚Äã‡§∏‡•Ä ‡§ê‡§Ç ‡§ï‡§°‡•á Cash ‡§∂‡§ø‡§≤‡•ç‡§≤‡§ï ‡§Ö‡§∏‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ï‡§æ‡§∞‡§£</label>
                            <textarea data-label="BM_Note_On_Cash_With_CA_Why" class="pro-input h-28 dyn-bm" placeholder="‡§ú‡§∞ ‡§∂‡§ø‡§≤‡•ç‡§≤‡§ï ‡§Ö‡§∏‡•á‡§≤ ‡§§‡§∞ ‡§ï‡§æ‡§∞‡§£ ‡§≤‡§ø‡§π‡§æ..."></textarea>
                        </div>
                        <div>
                            <label class="input-label">‡§µ‡§ø‡§∂‡•á‡§∑ ‡§®‡•ã‡§Ç‡§¶‡•Ä</label>
                            <textarea data-label="BM_IMP_NOTE_Customer_Staff" class="pro-input h-28 dyn-bm" placeholder="‡§Ü‡§ú‡§ö‡•ç‡§Ø‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§®‡•ã‡§Ç‡§¶‡•Ä (‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§∏‡•ç‡§ü‡§æ‡§´ ‡§µ‡§ø‡§∑‡§Ø‡§ï ‡§§‡§ï‡•ç‡§∞‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§∏ ‡§Ø‡•á‡§•‡•á ‡§®‡§Æ‡•Ç‡§¶ ‡§ï‡§∞‡§æ)..."></textarea>
                        </div>
                    </div>
                </div>
            </div>


  

<!-- Cluster Assistant (CA) SECTION START -->

            <div id="role-CA" class="role-section hidden">
                <div class="flex items-center gap-2 mb-5 ml-1">
                    <span class="h-3 w-3 bg-blue-600 rounded-full"></span>
                    <h2 class="font-black text-slate-800 uppercase tracking-widest text-sm">CA Daily Reporting</h2>
                </div>

                <div class="pro-card">
                    <h3 class="section-title">‡§µ‡§∏‡•Å‡§≤‡•Ä ‡§Ö‡§π‡§µ‡§æ‡§≤ (Recovery Report)</h3>
                    <div class="space-y-5">
                        <div class="p-5 bg-blue-50 rounded-3xl border border-blue-100">
                            <label class="block font-black text-blue-900 mb-3 uppercase text-[10px] tracking-widest">‚óè ‡§∞‡•á‡§ó‡•ç‡§Ø‡•Å‡§≤‡§∞ ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®</label>
                            <div class="flex gap-4">
                                <input type="number" data-label="CA_Reg_C" placeholder="‡§ó‡•ç‡§∞‡§æ‡§π‡§ï" class="pro-input dyn-ca">
                                <input type="number" data-label="CA_Reg_A" placeholder="‡§∞‡§ï‡•ç‡§ï‡§Æ ‚Çπ" class="pro-input dyn-ca amt-input">
                            </div>
                        </div>
                        <div class="p-5 bg-orange-50 rounded-3xl border border-orange-100">
                            <label class="block font-black text-orange-900 mb-3 uppercase text-[10px] tracking-widest">‚óè ‡§ì‡§°‡•Ä ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®</label>
                            <div class="flex gap-4">
                                <input type="number" data-label="CA_OD_C" placeholder="‡§ó‡•ç‡§∞‡§æ‡§π‡§ï" class="pro-input dyn-ca">
                                <input type="number" data-label="CA_OD_A" placeholder="‡§∞‡§ï‡•ç‡§ï‡§Æ ‚Çπ" class="pro-input dyn-ca amt-input">
                            </div>
                        </div>
                        <div class="p-5 bg-red-50 rounded-3xl border border-red-100">
                            <label class="block font-black text-red-900 mb-3 uppercase text-[10px] tracking-widest">‚óè ‡§™‡§æ‡§∏‡•ç‡§ü ‡§°‡•ç‡§Ø‡•Å (Past Due)</label>
                            <div class="flex gap-4">
                                <input type="number" data-label="CA_Past_C" placeholder="‡§ó‡•ç‡§∞‡§æ‡§π‡§ï" class="pro-input dyn-ca">
                                <input type="number" data-label="CA_Past_A" placeholder="‡§∞‡§ï‡•ç‡§ï‡§Æ ‚Çπ" class="pro-input dyn-ca amt-input">
                            </div>
                        </div>
                        <div class="p-5 bg-red-50 rounded-3xl border border-red-100">
                            <label class="block font-black text-red-900 mb-3 uppercase text-[10px] tracking-widest">‚óè ‡§π‡§æ‡§§‡§æ‡§µ‡§∞‡•Ä‡§≤ ‡§∂‡§ø‡§≤‡•ç‡§≤‡§ï & ‡§ï‡§æ‡§∞‡§£ </label>
                            <div class="flex gap-4">
                                <input type="number" data-label="CA_Hand_Cash_Amt" placeholder="‡§Ü‡§ú‡§ö‡•Ä ‡§π‡§æ‡§§‡§æ‡§µ‡§∞‡•Ä‡§≤ ‡§∂‡§ø‡§≤‡•ç‡§≤‡§ï " class="pro-input dyn-ca">
                                <input type="text" data-label="CA_Hand_Cash_Reason" placeholder="‡§π‡§æ‡§§‡§æ‡§µ‡§∞ ‡§∞‡§ï‡•ç‡§ï‡§Æ ‡§Ö‡§∏‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§ï‡§æ‡§∞‡§£ ‡§ï‡§æ‡§Ø " class="pro-input dyn-ca">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pro-card">
                    <h3 class="section-title">‡§´‡•Ä‡§≤‡•ç‡§° ‡§µ‡§∞‡•ç‡§ï ‡§§‡§™‡§∂‡•Ä‡§≤</h3>
                    <div class="space-y-5">
                        <div class="grid grid-cols-2 gap-5">
                            <div><label class="input-label">‡§¨‡•à‡§†‡§ï ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ</label><input type="number" data-label="CA_Meet" class="pro-input dyn-ca" placeholder="0"></div>
                            <div><label class="input-label">‡§ó‡§æ‡§µ‡§æ‡§ö‡•á ‡§®‡§æ‡§µ</label><input type="text" data-label="CA_Vill" class="pro-input dyn-ca" placeholder="‡§®‡§æ‡§Ç‡§µ..."></div>
                            <div><label class="input-label">‡§ï‡§ø‡§§‡•Ä ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§Ç‡§ö‡•á ‚Äã‡§ï‡•á ‡§µ‡§æ‡§Ø ‡§∏‡•Ä ‡§Ü‡§ú ‡§ò‡•á‡§§‡§≤‡•á </label><input type="number" data-label="KYC_Collected" class="pro-input dyn-ca" placeholder="‡§ï‡•á ‡§µ‡§æ‡§Ø ‡§∏‡•Ä No..."></div>
                            <div><label class="input-label">‡§ï‡§ø‡§§‡•Ä ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§Ç‡§ö‡•á ‡§´‡•â‡§∞‡•ç‡§Æ ‡§™‡•Å‡§∞‡•ç‡§£ ‡§ï‡•á‡§≤‡•á</label><input type="number" data-label="Forms_Filled" class="pro-input dyn-ca" placeholder="‡§´‡•â‡§∞‡•ç‡§Æ ‡§™‡•Å‡§∞‡•ç‡§£ ..."></div>
                            <div><label class="input-label">‡§ï‡§ø‡§§‡•Ä ‡§ó‡•ç‡§∞‡§æ‡§π‡§æ‡§ï‡§æ‡§Ç‡§ö‡•á ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§£‡•á ‡§¨‡§æ‡§ï‡•Ä ‡§Ü‡§π‡•á </label><input type="number" data-label="Forms_Pending" class="pro-input dyn-ca" placeholder="‡§´‡•â‡§∞‡•ç‡§Æ ‡§™‡•Å‡§∞‡•ç‡§£ ..."></div>
                            <div><label class="input-label">‡§Ö‡•Ö‡§ü‡•ã ‡§™‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§®‡§ö‡•á ‡§ï‡§ø‡§§‡•Ä ‡§´‡•â‡§∞‡•ç‡§Æ ‡§Ü‡§ú ‡§≠‡§∞‡§≤‡•á  </label><input type="number" data-label="Auto_Pay_Done" class="pro-input dyn-ca" placeholder="‡§´‡•â‡§∞‡•ç‡§Æ ‡§™‡•Å‡§∞‡•ç‡§£ ..."></div>
                        </div>
                        <div>
                            <label class="input-label">‡§Ü‡§ú‡§ö‡•ç‡§Ø‡§æ ‡§ï‡§æ‡§Æ‡§æ‡§§‡•Ä‡§≤ ‡§Ö‡§°‡§ö‡§£‡•Ä ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§ï‡§æ‡§π‡•Ä ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•ã‡§§‡•ç‡§Ø‡§æ ‡§ï‡§æ ‡§Ö‡§∏‡§§‡•Ä‡§≤ ‡§§‡§∞ ‡§§‡•ç‡§Ø‡§æ ‡§ï‡§≥‡§µ‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§µ‡§∞‡§ø‡§∑‡•ç‡§†‡§æ‡§Ç‡§µ‡§ø‡§∑‡§Ø‡•Ä ‡§ï‡§æ‡§π‡•Ä ‡§Ö‡§°‡§ö‡§£ ‡§Ü‡§π‡•á ‡§ï‡§æ‡§Ø ‡§§‡•á ‡§ï‡§≥‡§µ‡§æ </label>
                            <textarea data-label="CA_Issues" class="pro-input h-32 dyn-ca" placeholder="‡§ï‡§æ‡§Æ‡§æ‡§§ ‡§Ü‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§Ø‡•á‡§•‡•á ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§ï‡§∞‡§æ..."></textarea>
                        </div>
                    </div>
                </div>
            </div>


<!-- Unit Accountant (TA) SECTION START -->

<div id="role-TA" class="role-section hidden">
    <div class="flex items-center gap-2 mb-5 ml-1">
        <span class="h-3 w-3 bg-green-600 rounded-full"></span>
        <h2 class="font-black text-slate-800 uppercase tracking-widest text-sm">
            TA ‚Äì ‡§Ø‡•Å‡§®‡§ø‡§ü ‡§Ö‡§ï‡§æ‡§ä‡§Ç‡§ü‡§Ç‡§ü ‡§Ö‡§π‡§µ‡§æ‡§≤
        </h2>
    </div>

    <div class="pro-card">
        <h3 class="section-title">‡§¶‡•à‡§®‡§ø‡§ï ‡§Ö‡§ï‡§æ‡§ä‡§Ç‡§ü‡§ø‡§Ç‡§ó ‡§µ ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§Ö‡§π‡§µ‡§æ‡§≤</h3>

        <div class="space-y-5">

            <!-- Analysis Report -->
            <div class="p-5 bg-green-50 rounded-3xl border border-green-100">
                <label class="block font-black text-green-900 mb-3 uppercase text-[10px] tracking-widest">
                    ‚óè ‡§Ö‡•Ö‡§®‡§æ‡§≤‡§ø‡§∏‡•Ä‡§∏ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü
                </label>
                <input type="number"
                       data-label="TA_Analysis_Report_Count"
                       placeholder="‡§Ü‡§ú ‡§ï‡§ø‡§§‡•Ä ‡§Ö‡•Ö‡§®‡§æ‡§≤‡§ø‡§∏‡•Ä‡§∏ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡§æ‡§¢‡§≤‡•á?"
                       class="pro-input dyn-ta">
            </div>

            <!-- Collection Match -->
            <div class="p-5 bg-blue-50 rounded-3xl border border-blue-100">
                <label class="block font-black text-blue-900 mb-3 uppercase text-[10px] tracking-widest">
                    ‚óè ‡§Ü‡§ú‡§ö‡•á ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•Ö‡§ö
                </label>
                <select data-label="TA_Collection_Matched" class="pro-input dyn-ta">
                    <option value="">-- ‡§®‡§ø‡§µ‡§°‡§æ --</option>
                    <option value="Yes">‡§π‡•ã‡§Ø</option>
                    <option value="No">‡§®‡§æ‡§π‡•Ä</option>
                </select>
            </div>

            <!-- Cash Control -->
            <div class="p-5 bg-red-50 rounded-3xl border border-red-100">
                <label class="block font-black text-red-900 mb-4 uppercase text-[10px] tracking-widest">
                    ‚óè ‡§ï‡•Ö‡§∂ ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤
                </label>

                <div class="grid grid-cols-2 gap-4">
                    <input type="number"
                           data-label="TA_Cash_In_Hand"
                           placeholder="‡§Ü‡§ú‡§ö‡•Ä Cash In Hand ‚Çπ"
                           class="pro-input dyn-ta amt-input">

                    <select data-label="TA_Bank_Deposit_Done" class="pro-input dyn-ta">
                        <option value="">‡§¨‡§Å‡§ï‡•á‡§§ ‡§°‡§ø‡§™‡•â‡§ù‡§ø‡§ü ‡§ù‡§æ‡§≤‡•á ‡§ï‡§æ?</option>
                        <option value="Yes">‡§π‡•ã‡§Ø</option>
                        <option value="No">‡§®‡§æ‡§π‡•Ä</option>
                    </select>
                </div>

                <input type="text"
                       data-label="TA_Deposit_Reason"
                       placeholder="‡§°‡§ø‡§™‡•â‡§ù‡§ø‡§ü ‡§®‡§∏‡•á‡§≤ ‡§§‡§∞ ‡§ï‡§æ‡§∞‡§£"
                       class="pro-input dyn-ta mt-3">
            </div>

            <!-- System Update Dates -->
            <div class="p-5 bg-orange-50 rounded-3xl border border-orange-100">
                <label class="block font-black text-orange-900 mb-4 uppercase text-[10px] tracking-widest">
                    ‚óè ‡§∏‡§ø‡§∏‡•ç‡§ü‡•Ä‡§Æ ‡§Ö‡§™‡§°‡•á‡§ü ‡§§‡§æ‡§∞‡•Ä‡§ñ
                </label>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="input-label">Finance System</label>
                        <input type="date"
                               data-label="TA_Finance_System_Date"
                               class="pro-input dyn-ta">
                    </div>

                    <div>
                        <label class="input-label">SPMBT_System</label>
                        <input type="date"
                               data-label="TA_SPMB_System_Date"
                               class="pro-input dyn-ta">
                    </div>
                </div>
            </div>

            <!-- CA Report Verification -->
            <div class="p-5 bg-indigo-50 rounded-3xl border border-indigo-100">
                <label class="block font-black text-indigo-900 mb-3 uppercase text-[10px] tracking-widest">
                    ‚óè CA ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§µ‡•ç‡§π‡•á‡§∞‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§®
                </label>

                <select data-label="TA_All_CA_Report_Received" class="pro-input dyn-ta mb-3">
                    <option value="">‡§∏‡§∞‡•ç‡§µ CA ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§µ‡•á‡§≥‡•á‡§§ ‡§Ü‡§≤‡•á ‡§ï‡§æ?</option>
                    <option value="Yes">‡§π‡•ã‡§Ø</option>
                    <option value="No">‡§®‡§æ‡§π‡•Ä</option>
                </select>

                <input type="text"
                       data-label="TA_CA_Pending_Names"
                       placeholder="Pending / ‡§ö‡•Å‡§ï‡•Ä‡§ö‡•á CA ‡§®‡§æ‡§µ‡•á"
                       class="pro-input dyn-ta">
            </div>

            <!-- OD / Past Due -->
            <div class="p-5 bg-pink-50 rounded-3xl border border-pink-100">
                <label class="block font-black text-pink-900 mb-3 uppercase text-[10px] tracking-widest">
                    ‚óè ‡§Ü‡§ú ‡§ù‡§æ‡§≤‡•á‡§≤‡•á New Loan Disbursement ‡§∏‡§∞‡•ç‡§µ ‡§∏‡§ø‡§∏‡•ç‡§ü‡•Ä‡§Æ‡§≤‡§æ ‡§ò‡•á‡§§‡§≤‡•á ‡§ï‡§æ‡§Ø 
                </label>

                <div class="grid grid-cols-2 gap-4">
                    <select data-label="TA_New_OD_Today" class="pro-input dyn-ta">
                        <option value="">‡§Ü‡§ú  ‡§ù‡§æ‡§≤‡•á‡§≤‡•á New Loan Disbursement ‡§∏‡§∞‡•ç‡§µ ‡§∏‡§ø‡§∏‡•ç‡§ü‡•Ä‡§Æ‡§≤‡§æ ‡§ò‡•á‡§§‡§≤?</option>
                        <option value="Yes">‡§π‡•ã‡§Ø</option>
                        <option value="No">‡§®‡§æ‡§π‡•Ä</option>
                    </select>

                    <input type="‡§∞‡§ï‡•ç‡§ï‡§Æ Loan Disbursement"
                           data-label="TA_Loan_Dis"
                           placeholder="Amount ‚Çπ"
                           class="pro-input dyn-ta amt-input">
                </div>
            </div>

            <!-- Auto EMI -->
            <div class="p-5 bg-teal-50 rounded-3xl border border-teal-100">
                <label class="block font-black text-teal-900 mb-3 uppercase text-[10px] tracking-widest">
                    ‚óè Auto EMI ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤
                </label>

                <div class="grid grid-cols-2 gap-4">
                    <input type="number"
                           data-label="TA_Auto_EMI_Activated"
                           placeholder="‡§Ü‡§ú ‡§ï‡§ø‡§§‡•Ä Auto EMI ‡§≤‡§æ‡§ó‡•Ç?"
                           class="pro-input dyn-ta">

                    <input type="number"
                           data-label="TA_Auto_EMI_Failed"
                           placeholder="‡§Ü‡§ú ‡§ï‡§ø‡§§‡•Ä Auto EMI Fail?"
                           class="pro-input dyn-ta">
                </div>
            </div>

            <!-- Recovery Tracker -->
            <div class="p-5 bg-purple-50 rounded-3xl border border-purple-100">
                <label class="block font-black text-purple-900 mb-3 uppercase text-[10px] tracking-widest">
                    ‚óè ‡§∞‡§ø‡§ï‡§µ‡•ç‡§π‡§∞‡•Ä ‡§ü‡•ç‡§∞‡•Ö‡§ï‡§∞
                </label>
                <select data-label="TA_Recovery_Tracker_Sent" class="pro-input dyn-ta">
                    <option value="">‡§Ü‡§ú ‡§∞‡§ø‡§ï‡§µ‡•ç‡§π‡§∞‡•Ä ‡§ü‡•ç‡§∞‡•Ö‡§ï‡§∞ ‡§™‡§æ‡§†‡§µ‡§≤‡§æ ‡§ï‡§æ?</option>
                    <option value="Yes">‡§π‡•ã‡§Ø</option>
                    <option value="No">‡§®‡§æ‡§π‡•Ä</option>
                </select>
            </div>

            <!-- Special Notes -->
            <div>
                <label class="input-label">‡§Ü‡§ú‡§ö‡•ç‡§Ø‡§æ ‡§á‡§§‡§∞ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§®‡•ã‡§Ç‡§¶‡•Ä</label>
                <textarea data-label="TA_Special_Notes"
                          class="pro-input h-32 dyn-ta"
                          placeholder="Audit, HO ‡§∏‡•Ç‡§ö‡§®‡§æ, ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§Æ‡§π‡§§‡•ç‡§µ‡§æ‡§ö‡•ç‡§Ø‡§æ ‡§®‡•ã‡§Ç‡§¶‡•Ä ‡§Ø‡•á‡§•‡•á ‡§≤‡§ø‡§π‡§æ..."></textarea>
            </div>

            <!-- Declaration -->
            <div class="p-5 bg-slate-50 rounded-3xl border border-slate-200">
                <label class="block font-black text-slate-900 mb-3 uppercase text-[10px] tracking-widest">
                    ‚óè TA ‡§°‡§ø‡§ï‡•ç‡§≤‡•á‡§∞‡•á‡§∂‡§®
                </label>
                <select data-label="TA_Declaration" class="pro-input dyn-ta">
                    <option value="">‡§Ü‡§ú‡§ö‡§æ ‡§∏‡§∞‡•ç‡§µ ‡§°‡•á‡§ü‡§æ ‡§¨‡§∞‡•ã‡§¨‡§∞ ‡§Ü‡§π‡•á ‡§ï‡§æ?</option>
                    <option value="Yes">‡§π‡•ã‡§Ø</option>
                    <option value="No">‡§®‡§æ‡§π‡•Ä</option>
                </select>
            </div>

        </div>
    </div>
</div>

<!-- Unit Accountant (TA) SECTION END -->



            <!-- FIELD EXECUTIVE (FX) SECTION -->
            <div id="role-FX" class="role-section hidden">
                <div class="flex items-center gap-2 mb-5 ml-1">
                    <span class="h-3 w-3 bg-blue-600 rounded-full"></span>
                    <h2 class="font-black text-slate-800 uppercase tracking-widest text-sm">FX Daily Reporting</h2>
                </div>

                <!-- Point 1 Accordion -->
                <div class="accordion-item shadow-sm">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="flex items-center gap-3">
                            <span class="bg-blue-900 text-white w-7 h-7 rounded-lg flex items-center justify-center text-xs font-black">1</span>
                            <span class="font-bold text-slate-700">‡§Ü‡§ú‡§ö‡•Ä ‡§∞‡§ø‡§ï‡§µ‡•ç‡§π‡§∞‡•Ä (Reg + OD)</span>
                        </div>
                        <span class="arrow transition-transform text-xs text-slate-400">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="table-wrap">
                            <table id="table1">
                                <thead><tr><th>CA Name</th><th class="w-20">Ac</th><th class="w-32">Amt (‚Çπ)</th></tr></thead>
                                <tbody id="fxT1"></tbody>
                                <tfoot><tr class="total-row"><td>Total</td><td id="t1-ac">0</td><td id="t1-amt">0</td></tr></tfoot>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Point 2 Accordion -->
                <div class="accordion-item shadow-sm">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="flex items-center gap-3">
                            <span class="bg-blue-900 text-white w-7 h-7 rounded-lg flex items-center justify-center text-xs font-black">2</span>
                            <span class="font-bold text-slate-700">‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•ã‡§° (Cash & Digital)</span>
                        </div>
                        <span class="arrow transition-transform text-xs text-slate-400">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="table-wrap">
                            <table id="table2">
                                <thead><tr><th>CA Name</th><th>Cash</th><th>Digital</th><th>Total</th></tr></thead>
                                <tbody id="fxT2"></tbody>
                                <tfoot><tr class="total-row"><td>Total</td><td id="t2-cash">0</td><td id="t2-digi">0</td><td id="t2-total">0</td></tr></tfoot>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Point 3 Accordion -->
                <div class="accordion-item shadow-sm">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="flex items-center gap-3">
                            <span class="bg-blue-900 text-white w-7 h-7 rounded-lg flex items-center justify-center text-xs font-black">3</span>
                            <span class="font-bold text-slate-700">‡§∏‡•Ä ‡§ê ‡§®‡§ø‡§π‡§æ‡§Ø ‡§π‡§æ‡§§‡§æ‡§µ‡§∞ ‡§∂‡§ø‡§≤‡•ç‡§≤‡§ï ‡§ï‡•Ö‡§∂</span>
                        </div>
                        <span class="arrow transition-transform text-xs text-slate-400">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="table-wrap">
                            <table>
                                <thead><tr><th>CA Name</th><th class="w-28">Cash (‚Çπ)</th><th>Reason</th></tr></thead>
                                <tbody id="fxT3"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Point 4 Accordion -->
                <div class="accordion-item shadow-sm">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="flex items-center gap-3">
                            <span class="bg-blue-900 text-white w-7 h-7 rounded-lg flex items-center justify-center text-xs font-black">4</span>
                            <span class="font-bold text-slate-700">‡§∏‡•Ä ‡§ê ‡§®‡§ø‡§π‡§æ‡§Ø ‡§ì‡§°‡•Ä ‡§Ö‡§π‡§µ‡§æ‡§≤</span>
                        </div>
                        <span class="arrow transition-transform text-xs text-slate-400">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="table-wrap">
                            <table>
                                <thead><tr><th>CA Name</th><th class="w-20">Ac</th><th class="w-32">Amount</th></tr></thead>
                                <tbody id="fxT4"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Point 5-9 Combined Accordion -->
                <div class="accordion-item shadow-sm">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="flex items-center gap-3">
                            <span class="bg-blue-900 text-white w-7 h-7 rounded-lg flex items-center justify-center text-xs font-black">5</span>
                            <span class="font-bold text-slate-700">‡§á‡§§‡§∞ ‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§µ ‡§®‡•ã‡§Ç‡§¶‡•Ä</span>
                        </div>
                        <span class="arrow transition-transform text-xs text-slate-400">‚ñº</span>
                    </div>
                    <div class="accordion-content space-y-6">
                        <div class="p-4 bg-slate-50 rounded-2xl">
                            <p class="font-black text-[10px] text-slate-500 mb-3 uppercase underline">‡•´. ‡§Ü‡§™‡§≤‡•ç‡§Ø‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§®‡§æ‡§Ç‡§§‡•Ç‡§® ‡§µ‡§∏‡•Å‡§≤‡•Ä</p>
                            <div class="grid grid-cols-2 gap-4">
                                <input type="number" data-label="FX_P5_Acc" class="pro-input dyn-fx" placeholder="‡§ñ‡§æ‡§§‡•á">
                                <input type="number" data-label="FX_P5_Amt" class="pro-input dyn-fx amt-input" placeholder="‡§∞‡§ï‡•ç‡§ï‡§Æ ‚Çπ">
                            </div>
                        </div>

                        <div class="p-4 bg-slate-50 rounded-2xl">
                            <p class="font-black text-[10px] text-slate-500 mb-3 uppercase underline">‡•¨. ‡§≤‡•ã‡§® ‡§Ö‡•Ö‡§™‡•ç‡§∞‡§æ‡§Ø‡§ù‡§≤ ‡§Ö‡§π‡§µ‡§æ‡§≤</p>
                            <div class="grid grid-cols-2 gap-4 mb-3">
                                <input type="number" data-label="FX_P6_Cnt" class="pro-input dyn-fx" placeholder="‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ">
                                <input type="number" data-label="FX_P6_Rej" class="pro-input dyn-fx" placeholder="‡§∞‡§¶‡•ç‡§¶">
                                <input type="number" data-label="Apprisal_Dis_Done" class="pro-input dyn-fx" placeholder="‡§ú‡•á ‡§Ö‡•Ö‡§™‡•ç‡§∞‡§æ‡§Ø‡§ù‡§∞ ‡§ù‡§æ‡§≤‡•á‡§≤‡•á ‡§Ü‡§π‡•á‡§§ ‡§§‡•ç‡§Ø‡§æ ‡§™‡•à‡§ï‡•Ä ‡§µ‡§æ‡§ü‡§™ ‡§ï‡§ø‡§§‡•Ä ">
                                <input type="number" data-label="Apprisal_Dis_Pending" class="pro-input dyn-fx" placeholder="‡§ú‡•á ‡§Ö‡•Ö‡§™‡•ç‡§∞‡§æ‡§Ø‡§ù‡§∞ ‡§ù‡§æ‡§≤‡•á‡§≤‡•á ‡§Ü‡§π‡•á‡§§ ‡§§‡•ç‡§Ø‡§æ ‡§™‡•à‡§ï‡•Ä ‡§µ‡§æ‡§ü‡§™ ‡§¨‡§æ‡§ï‡•Ä ‡§ï‡§ø‡§§‡•Ä  ">
                            </div>
                            <input type="text" data-label="FX_P6_Vill" class="pro-input dyn-fx" placeholder="‡§Ü‡§ú ‡§ú‡•ç‡§Ø‡§æ ‡§ó‡§æ‡§µ‡§æ‡§§ ‡§ù‡§æ‡§≤‡•á ‡§§‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§ó‡§æ‡§µ‡§æ‡§ö‡•Ä ‡§®‡§æ‡§µ‡•á">
                        </div>

                        <div class="p-4 bg-slate-50 rounded-2xl">
                            <p class="font-black text-[10px] text-slate-500 mb-3 uppercase underline">‡•≠. ‡§∏‡•Ä ‡§ê ‡§®‡§ø‡§π‡§æ‡§Ø ‡§ë‡§ü‡•ã‡§™‡•á</p>
                            <div class="table-wrap"><table><thead><tr><th>CA Name</th><th>Count</th></tr></thead><tbody id="fxT7"></tbody></table></div>
                        </div>

                        <div><label class="input-label">‡•Æ. ‡§Ü‡§ú‡§ö‡•ç‡§Ø‡§æ ‡§Æ‡§π‡§§‡•ç‡§µ‡§æ‡§ö‡•ç‡§Ø‡§æ ‡§®‡•ã‡§Ç‡§¶‡•Ä</label><textarea data-label="FX_P8_Notes" class="pro-input h-20 dyn-fx"></textarea></div>
                        <div><label class="input-label">‡•Ø. ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§§‡§ï‡•ç‡§∞‡§æ‡§∞‡•Ä ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§µ‡§∞‡§ø‡§∑‡•ç‡§† ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§∏‡•Ä ‡§ê ‡§µ‡§ø‡§∑‡§Ø‡•Ä ‡§ï‡•ç‡§∞‡§æ‡§π‡•Ä ‡§§‡§ï‡•ç‡§∞‡§æ‡§∞ ‡§Ü‡§π‡•á ‡§ï‡§æ‡§Ø </label><textarea data-label="FX_P9_Complaints" class="pro-input h-20 dyn-fx"></textarea></div>
                    </div>
                </div>
            </div>

        </form>
    </div>

    <!-- 2. STICKY ACTION BAR -->
    <div id="stickyBar" class="sticky-action-bar">
        <!-- 3. FX MATCH STATUS INDICATOR -->
        <div id="fxStatusIndicator" class="hidden flex-1">
            <div class="flex flex-col">
                <span class="text-[9px] font-black text-slate-400 uppercase leading-none mb-1">Recovery Match</span>
                <span id="matchBadge" class="badge badge-fail block text-center">Mismatch ‚ùå</span>
            </div>
        </div>
        
        <button type="button" onclick="submitFinalData()" id="finalBtn" class="flex-[2] bg-emerald-600 text-white py-4 md:py-5 rounded-2xl font-black text-lg md:text-xl shadow-xl active:scale-95 transition-transform uppercase tracking-wider">
            ‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§ú‡§§‡§® ‡§ï‡§∞‡§æ (Submit)
        </button>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxrvpj1lV-6ulFBibnRpui38FCElGlacPetW_ToO3uU8LnqLIT5BhKmE3ijCgIsy_U/exec"; 
        
        let staffData = [];
        let totalAmt1 = 0; 
        let totalAmt2 = 0;
        let isAlreadySubmitted = false;

        // Init App
        window.onload = async () => {
            const dateInput = document.getElementById('reportDate');
            const today = new Date();
            const minDate = new Date();
            minDate.setDate(today.getDate() - 2); 

            dateInput.valueAsDate = today;
            dateInput.min = minDate.toISOString().split('T')[0];
            dateInput.max = today.toISOString().split('T')[0];

            try {
                const response = await fetch(SCRIPT_URL + "?action=getStaff");
                staffData = await response.json();
                const branches = [...new Set(staffData.map(s => s[2]))];
                const unitDropdown = document.getElementById('unitSelect');
                unitDropdown.innerHTML = '<option value="">-- ‡§∂‡§æ‡§ñ‡§æ ‡§®‡§ø‡§µ‡§°‡§æ --</option>' + 
                    branches.map(b => `<option value="${b}">${b}</option>`).join('');
            } catch (error) { console.error("API Load Failed"); }
        };

        // UI Logic: Accordion Toggle
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('.arrow');
            const isOpen = content.style.display === "block";
            
            // Close all
            document.querySelectorAll('.accordion-content').forEach(c => c.style.display = "none");
            document.querySelectorAll('.arrow').forEach(a => a.style.transform = "rotate(0deg)");
            document.querySelectorAll('.accordion-header').forEach(h => h.classList.remove('active'));

            // Open clicked
            if (!isOpen) {
                content.style.display = "block";
                header.classList.add('active');
                arrow.style.transform = "rotate(180deg)";
            }
        }

        function filterStaff() {
            const branch = document.getElementById('unitSelect').value;
            const staff = staffData.filter(s => s[2] === branch);
            const select = document.getElementById('empSelect');
            select.innerHTML = '<option value="">-- ‡§®‡§æ‡§µ ‡§®‡§ø‡§µ‡§°‡§æ --</option>' + 
                staff.map(p => `<option value="${p[0]}" data-role="${p[1]}" data-cas="${p[3]}">${p[0]}</option>`).join('');
            checkStatusAndInit();
        }

        async function checkStatusAndInit() {
            const name = document.getElementById('empSelect').value;
            const date = document.getElementById('reportDate').value;
            if(!name || !date) return;

            resetUI();
            document.getElementById('loader-overlay').style.display = "flex";

            try {
                const res = await fetch(`${SCRIPT_URL}?action=checkStatus&name=${encodeURIComponent(name)}&date=${date}`);
                const status = await res.json();
                document.getElementById('loader-overlay').style.display = "none";

                if(status.submitted) {
                    isAlreadySubmitted = true;
                    document.getElementById('duplicateMsg').style.display = "block";
                    document.getElementById('stickyBar').classList.remove('visible');
                } else {
                    isAlreadySubmitted = false;
                    handleLeave();
                }
            } catch(e) { document.getElementById('loader-overlay').style.display = "none"; }
        }

        function resetUI() {
            document.getElementById('masterForm').classList.add('hidden');
            document.getElementById('duplicateMsg').style.display = "none";
            document.getElementById('leaveConfirmation').classList.add('hidden');
            document.getElementById('stickyBar').classList.remove('visible');
        }

        function handleLeave() {
            if(isAlreadySubmitted) return;
            const isLeave = document.getElementById('leaveSelect').value === "‡§π‡•ã";
            const staff = document.getElementById('empSelect').selectedOptions[0];

            if(!staff || !staff.value) return;

            if(isLeave) {
                document.getElementById('masterForm').classList.add('hidden');
                document.getElementById('leaveConfirmation').classList.remove('hidden');
                document.getElementById('stickyBar').classList.add('visible');
                document.getElementById('fxStatusIndicator').classList.add('hidden');
            } else {
                document.getElementById('leaveConfirmation').classList.add('hidden');
                showForm(staff);
            }
        }

        function showForm(staffOpt) {
            const role = staffOpt.getAttribute('data-role');
            const cas = staffOpt.getAttribute('data-cas') ? staffOpt.getAttribute('data-cas').split(',') : [];

            document.querySelectorAll('.role-section').forEach(s => s.classList.add('hidden'));
            document.getElementById('masterForm').classList.remove('hidden');
            document.getElementById('stickyBar').classList.add('visible');
            document.getElementById('role-' + role).classList.remove('hidden');

            if(role === 'FX') {
                document.getElementById('fxStatusIndicator').classList.remove('hidden');
                buildFXRows(cas);
            } else {
                document.getElementById('fxStatusIndicator').classList.add('hidden');
            }
        }

        function buildFXRows(caList) {
            const t1 = document.getElementById('fxT1'), t2 = document.getElementById('fxT2'), t3 = document.getElementById('fxT3'), t4 = document.getElementById('fxT4'), t7 = document.getElementById('fxT7');
            t1.innerHTML = t2.innerHTML = t3.innerHTML = t4.innerHTML = t7.innerHTML = "";

            caList.forEach(ca => {
                const name = ca.trim();
                t1.innerHTML += `<tr><td class="text-[10px] font-bold">${name}</td><td><input type="number" data-tag="Ac" class="pro-input h-8 p-1 text-center calc-fx-1"></td><td><input type="number" data-tag="Amt" class="pro-input h-8 p-1 text-center calc-fx-1 amt-input"></td></tr>`;
                t2.innerHTML += `<tr><td class="text-[10px] font-bold">${name}</td><td><input type="number" data-tag="Cash" class="pro-input h-8 p-1 text-center calc-fx-2"></td><td><input type="number" data-tag="Digi" class="pro-input h-8 p-1 text-center calc-fx-2"></td><td><input type="number" readonly class="pro-input h-8 p-1 text-center bg-slate-50 font-bold"></td></tr>`;
                t3.innerHTML += `<tr><td class="text-[10px] font-bold">${name}</td><td><input type="number" data-tag="H_Cash" class="pro-input h-8 p-1 text-center amt-input"></td><td><input type="text" data-tag="H_Why" class="pro-input h-8 p-1" placeholder="..."></td></tr>`;
                t4.innerHTML += `<tr><td class="text-[10px] font-bold">${name}</td><td><input type="number" data-tag="OD_Ac" class="pro-input h-8 p-1 text-center"></td><td><input type="number" data-tag="OD_Amt" class="pro-input h-8 p-1 text-center amt-input"></td></tr>`;
                t7.innerHTML += `<tr><td class="text-[10px] font-bold">${name}</td><td><input type="number" data-tag="Auto_Done" class="pro-input h-8 p-1 text-center"></td></tr>`;
            });

            document.querySelectorAll('.calc-fx-1').forEach(i => i.oninput = calcT1);
            document.querySelectorAll('.calc-fx-2').forEach(i => i.oninput = calcT2);
            document.querySelector('.accordion-header').click(); // Auto-open first
        }

        function calcT1() {
            let ac = 0, amt = 0;
            document.querySelectorAll('#fxT1 tr').forEach(r => {
                ac += parseFloat(r.cells[1].querySelector('input').value) || 0;
                amt += parseFloat(r.cells[2].querySelector('input').value) || 0;
            });
            document.getElementById('t1-ac').innerText = ac;
            document.getElementById('t1-amt').innerText = amt;
            totalAmt1 = amt; checkFXMatch();
        }

        function calcT2() {
            let cash = 0, digi = 0, tot = 0;
            document.querySelectorAll('#fxT2 tr').forEach(r => {
                let cv = parseFloat(r.cells[1].querySelector('input').value) || 0;
                let dv = parseFloat(r.cells[2].querySelector('input').value) || 0;
                let rv = cv + dv;
                r.cells[3].querySelector('input').value = rv;
                cash += cv; digi += dv; tot += rv;
            });
            document.getElementById('t2-cash').innerText = cash;
            document.getElementById('t2-digi').innerText = digi;
            document.getElementById('t2-total').innerText = tot;
            totalAmt2 = tot; checkFXMatch();
        }

        function checkFXMatch() {
            const b = document.getElementById('matchBadge');
            if(totalAmt1 > 0 && totalAmt1 === totalAmt2) {
                b.innerText = "Match ‚úÖ"; b.className = "badge badge-ok block text-center";
            } else {
                b.innerText = "Mismatch ‚ùå"; b.className = "badge badge-fail block text-center";
            }
        }

        async function submitFinalData() {
            if (isAlreadySubmitted) return;

            const st = document.getElementById('empSelect').selectedOptions[0];
            const name = st.value;
            const date = document.getElementById('reportDate').value;
            const leave = document.getElementById('leaveSelect').value;
            const role = st.getAttribute('data-role');
            const unit = document.getElementById('unitSelect').value;
            const cas = st.getAttribute('data-cas') ? st.getAttribute('data-cas').split(',') : [];

            // 1. Validation for FX (Only if working)
            if (leave === "‡§®‡§æ‡§π‡•Ä" && role === 'FX' && totalAmt1 !== totalAmt2) {
                alert("‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä: ‡§™‡•â‡§à‡§Ç‡§ü ‡•ß (Total Recovery) ‡§Ü‡§£‡§ø ‡§™‡•â‡§à‡§Ç‡§ü ‡•® (Cash+Digital) ‡§Æ‡§ß‡•Ä‡§≤ ‡§∞‡§ï‡§Æ‡§æ ‡§Æ‡•Ö‡§ö ‡§®‡§æ‡§π‡•Ä‡§§!"); 
                return;
            }

            if (!confirm("‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§ú‡§§‡§® ‡§ï‡§∞‡§æ‡§Ø‡§ö‡§æ ‡§ï‡§æ?")) return;

            document.getElementById('loader-overlay').style.display = "flex";
            document.getElementById('finalBtn').disabled = true;

            // 2. Prepare Payload
            const payload = { 
                report_date: date, 
                staff_name: name, 
                unit: unit, 
                leave_status: leave, 
                role: role, 
                details: {} 
            };

            // 3. Logic for "ON LEAVE"
            if (leave === "‡§π‡•ã") {
                if (role === 'FX') {
                    payload.details.p1 = cas.map(c => ({ "CA_Name": c.trim(), "Ac": 0, "Amt": 0 }));
                    payload.details.extra = { "FX_P8_Notes": "‡§∞‡§ú‡•á‡§µ‡§∞ (On Leave)" };
                } else if (role === 'BM') {
                    payload.details.fields = { "BM_Meet_Notes": "‡§∞‡§ú‡•á‡§µ‡§∞ (On Leave)" };
                } else if (role === 'TA') {
                    payload.details.fields = { "TA_Special_Notes": "‡§∞‡§ú‡•á‡§µ‡§∞ (On Leave)" };
                } else {
                    payload.details.fields = { "CA_Issues": "‡§∞‡§ú‡•á‡§µ‡§∞ (On Leave)" };
                }
            } 
            // 4. Logic for "WORKING"
            else {
                if (role === 'FX') {
                    payload.details.p1 = extractT('fxT1');
                    payload.details.p2 = extractT('fxT2');
                    payload.details.p3 = extractT('fxT3');
                    payload.details.p4 = extractT('fxT4');
                    payload.details.p7 = extractT('fxT7');
                    payload.details.extra = extractF('.dyn-fx');
                } else if (role === 'BM') {
                    payload.details.fields = extractF('.dyn-bm');
                } else if (role === 'TA') {
                    payload.details.fields = extractF('.dyn-ta');
                } else {
                    payload.details.fields = extractF('.dyn-ca');
                }
            }

            // 5. Submit Data
            try {
                fetch(SCRIPT_URL, { 
                    method: 'POST', 
                    mode: 'no-cors', 
                    body: JSON.stringify(payload) 
                });
                
                // Success timeout to allow Sheets processing
                setTimeout(() => {
                    document.getElementById('loader-overlay').style.display = "none";
                    document.getElementById('successDetails').innerHTML = `
                        <div class="flex justify-between border-b pb-2"><span class="text-slate-400">‡§®‡§æ‡§µ:</span><span class="font-black">${name}</span></div>
                        <div class="flex justify-between border-b pb-2"><span class="text-slate-400">‡§∂‡§æ‡§ñ‡§æ:</span><span class="font-black">${unit}</span></div>
                        <div class="flex justify-between border-b pb-2"><span class="text-slate-400">‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï:</span><span class="font-black">${date}</span></div>
                        <div class="flex justify-between"><span class="text-slate-400">‡§∏‡•ç‡§•‡§ø‡§§‡•Ä:</span><span class="${leave === '‡§π‡•ã' ? 'text-red-600' : 'text-green-600'} font-black">${leave === '‡§π‡•ã' ? '‡§∞‡§ú‡§æ (LEAVE)' : '‡§ï‡§æ‡§Æ‡§æ‡§µ‡§∞ (WORKING)'}</span></div>
                    `;
                    document.getElementById('success-overlay').classList.remove('hidden');
                    document.getElementById('success-overlay').classList.add('flex');
                }, 3500);

            } catch (e) {
                alert("‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§è‡§∞‡§∞! ‡§ï‡•É‡§™‡§Ø‡§æ ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§§‡§™‡§æ‡§∏‡§æ."); 
                document.getElementById('loader-overlay').style.display = "none";
                document.getElementById('finalBtn').disabled = false;
            }
        }

        // Helper to extract table data (FX)
        function extractT(id) {
            return Array.from(document.querySelectorAll(`#${id} tr`)).map(r => {
                let o = { "CA_Name": r.cells[0].innerText.trim() };
                r.querySelectorAll('input').forEach(i => {
                    const tag = i.getAttribute('data-tag');
                    if(tag) o[tag] = i.value;
                });
                return o;
            });
        }

        // Helper to extract individual fields (BM, TA, CA, FX-Extra)
        function extractF(cls) {
            let o = {};
            document.querySelectorAll(cls).forEach(i => {
                const label = i.getAttribute('data-label');
                if(label) o[label] = i.value;
            });
            return o;
        }
    </script>
</body>
</html>
